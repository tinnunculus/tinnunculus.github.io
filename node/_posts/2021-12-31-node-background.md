---
layout: post
title: background
sitemap: false
---

**참고**  
[1] <https://thebook.io/080229/ch01/01/03-04/>  
* * *  

* toc
{:toc}

## anonymous
> * 자바스크립트 파일이 실행되면 생성되는 가장 기본적인 전역 context라고 볼 수 있다.
> * 가장 먼저 메모리 스택에 쌓이게 된다.
> <p align="center"><img width="500" src="/assets/img/node/background/1.png"></p>

## 이벤트 기반 시스템
> * 자바스크립트는 이벤트 기반의 시스템을 가지고 있다.
> * 이벤트 리스너와 콜백 함수의 개념을 가지고 있다.
> * 이벤트 리스너는 사용자가 설정할 수 있는 함수로 콜백 함수와 같이 사용된다.
> * 사용자가 이벤트 리스너를 call 하면 해당 이벤트 리스너는 콜백 함수와 같이 background로 이동하게 되고 해당 이벤트가 발생하면 콜백 함수를 메인 스레드에 올려서 실행시킨다.
> * 기본적인 함수의 실행과 처리는 메인 스레드에서 처리되지만 이벤트 기반의 background는 별도의 스레드, 프로세스로 처리한다.
> 
> ### 백그라운드
> > * 이벤트 리스너들이 대기하는 곳이다.
>
> ### 태스크 큐
> > * 이벤트 발생 후, 백그라운드에서 태스크 큐로 발생한 이벤트 리스너들의 콜백 함수를 보낸다.
> > * 이벤트가 발생한 순서대로 줄을 서 있으므로 콜백 큐라고도 불린다.
> 
> ### 마이크로태스크 큐
> > * 이벤트 발생 후, 백그라운드에서 마이크로태스크 큐로 발생한 이벤트 리스너들의 콜백 함수를 보낸다.
> > * 태스크 큐에 있는 콜백 함수들 보다 우선적으로 실행된다.
> > * 대표적으로 resolved된 Promise 객체의 then 메소드가 있다.
> 
> ### 이벤트 루프
> > * 함수 스택에서 anonymous 함수까지 실행이 완료되어 스택이 비어 있으면, 이벤트 루프는 태스크 큐나 마이크로태스크 큐에서 콜백 함수를 꺼내 스택에 올린다.
> > * 스택에 있는 함수가 노드의 메인 스레드에서 실행되고, 실행이 완료된 후 스택이 다시 비어지면 이벤트 루프는 다시 콜백 함수를 꺼내 스택에 올린다.
> > * 이 과정을 반복한다.
> 
> <p align="center"><img width="500" src="/assets/img/node/background/2.png"></p>
> <p align="center"><img width="500" src="/assets/img/node/background/3.png"></p>
> <p align="center"><img width="500" src="/assets/img/node/background/4.png"></p>